2장 MSA에 대한 이해
---
**소프트웨어 아키텍처**란 소프트웨어를 구성하는 요소와 그 구성요소 간의 관계를 정의한 것  
아키텍처를 정의하는 과정은 시스템 구축을 위한 다양한 영억에 대한 해결책을 찾는 과정이라고 할 수 있다.  

현대의 애플리케이션은 리액티브(reactive)한 속성을 가져야한다.  

#### 요나스 보네르의 리액티브 선언문  

1. 응답성(Responsive) : 사용자에게 신뢰성 있는 응답을 빠르고 적절하게 제공하는 것
2. 탄력성(Resilient) : 장애가 발생하거나 부분적으로 고장나더라도 시스템 전체가 고장나지않고 빠르게 회복하는 능력
3. 유연성(Elastic) : 시스템의 사용량에 변화가 있더라도 균일한 응답성을 제공하는 것
4. 메세지기반(Message Driven) : 비동기 메세지 전달을 통해 위치 투명성, 느슨한 결합, 논블로킹 통신을 지향하는 것

리액티브(reactive)란 다양한 상황에 따라 빠르고 적절하게 반응하는 시스템을 의미한다.  

---
현대의 오픈 소스는 유명한 벤더 제품군 만큼이나 품질이 높아지고 다양한 기능을 지원하면서 서로 다른 오픈소스  
제품 간에도 충분한 호환성을 제공하기 때문에 최근의 아키텍처 설계는 필요한 영역에 적절한 솔루션을 선택하고  
조합하는 개방적인 방식으로 바뀌고 있다.

1. 인프라 - VM, 베어메탈, AWS,Google Cloud, Azure
2. 플랫폼 - 데브옵스 파이프라인(Jenkins,SonarQube), 협업 환경(Jira, Confluence), 메세지 버스(Rabbit MQ, Kafka), 로깅중앙화  
   (ELK),라이브러리 저장소(Sonatype,Nexus), API Gateway(Netflix Zuul), 모니터링(Histrix),서비스 탐색(Eureka)
3. 애플리케이션 - 채널(모바일,브라우저), 핵심 서비스(프론트엔드, 백엔드),데이터(RDB,Redis 등)

기반이 되는 하드웨어 인프라가 있고, 인프라 위에 애플리케이션 구동을 위한 플랫폼이 올라가고, 플랫폼 위에 서비스가 구동된다.  
인프라 영역과 플랫폼 영역, 애플리케이션 영역에 있는 구성요소 및 그 관계들을 정의하는 것을 MSA 외부 아키텍처(Outer Architecture)라고 한다.  
실제 비즈니스가 실행되는 비즈니스 애플리케이션,즉 각 마이크로 서비스의 내부 구조를 정의해야 하는데 이를 MSA 내부 아키텍처(Inner architecture)
라고 한다.  

### 가상 머신(VM)과 컨테이너의 차이
가상 머신은 하이퍼바이저라는 소프트웨어 기술을 사용하여 하나의 시스템에서 여러개의 운영체제를 사용하는 기술이다.  
반면에, 컨테이너는 가상의 격리된 공간을 생성한다. 가장 큰 차이점은 게스트 OS의 유무이다.

### Docker
대표적인 컨테이너 기술로 도커 컨테이너는 레이어 단위의 이미지를 포개는 방식으로 구성된다.  
애플리케이션 구동을 위한 기반 이미지(Base RHEL), 운영체제, 런타임, 애플리케이션이 이미지로 정의 된다.

#### Docker의 장점
1. 이식성 : 어떠한 호스트 커널이나 플랫폼 버전에 상관없이 도커만 실행할 수 있으면 사용 가능하며 동일하게 동작된다.
2. 신속성 : 크기가 작고 가볍기 때문에 빠르게 배포 가능하며, 문제 발생 시 수정할 필요없이 새로 기동하면 된다.
3. 재사용성 : 동일한 환경을 재사용해서 쉽게 설정 가능하기 때문에 개발, 테스트, 스테이징, 프로덕트 환경을 동일한 환경으로 구축하기 쉽다.

#### 컨테이너 오케스트레이션  
컨테이너가 많아지면 그에 따른 자동 배치, 장애 복구, 확장 및 축소, 컨테이너 간 통신, 로드 밸런싱 등 컨테이너 관리 기능이 필요해진다.  
이러한 기술을 컨테이너 오케스트레이션(Container Orchestration)이라 한다.  
Docker 컨테이너 관리의 대표적인 기술이 바로 구글에서 공개한 쿠버네티스(Kubernetes)이다.

#### 쿠버네티스의 주요 기능
1. 자동화된 자원 배정(automatic binpacking) : 각 컨테이너가 필요로 하는 CPU와 메모리를 요청하면 컨테이너를 노드에 맞춰 자동 배치한다.
2. 셀프 치유(self-healing) : 컨테이너의 이상 유무를 점검해서 실패한 경우 자동 교체 및 재스케줄링한다.
3. 수평 확장(Horizontal scaling): 일정 CPU 및 메모리 사용량을 초과하면 자동으로 확장한다.